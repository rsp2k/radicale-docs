---
title: RFC 3253 - WebDAV Versioning (DeltaV)
description: First CalDAV server with complete RFC 3253 write operations - git-backed version control for calendars and contacts
---

import { Card, CardGrid } from '@astrojs/starlight/components';
import { Aside } from '@astrojs/starlight/components';
import { Code } from '@astrojs/starlight/components';

<Aside type="tip" title="Industry First">
**As of January 2025**, Radicale is the **first CalDAV server** to implement complete RFC 3253 write operations with git-backed version control.
</Aside>

## Overview

RFC 3253 defines **WebDAV Versioning and Configuration Management (DeltaV)**, enabling version history, checkout/checkin workflows, and change tracking for WebDAV resources. Radicale implements DeltaV for calendar and contact items using git as the underlying version control system.

**Compliance Level**: ~80% (all core write operations, partial advanced features)

## What's Implemented

### Core Version Control ✅

<CardGrid>
  <Card title="VERSION-CONTROL" icon="approve-check">
    Place a resource under version control. Creates initial git commit and enables version tracking.
  </Card>

  <Card title="CHECKOUT" icon="pencil">
    Lock a resource for editing. Prevents concurrent modifications with configurable fork policies.
  </Card>

  <Card title="CHECKIN" icon="approve-check-circle">
    Create a new version from edits. Commits changes to git and unlocks the resource.
  </Card>

  <Card title="UNCHECKOUT" icon="close">
    Cancel a checkout and discard changes. Restores resource to pre-checkout state.
  </Card>

  <Card title="LABEL" icon="seti:tag">
    Add, move, or remove version labels. Maps to git tags for marking important versions.
  </Card>

  <Card title="MKACTIVITY" icon="list-format">
    Create activities (change sets). Groups related changes across multiple resources.
  </Card>
</CardGrid>

### Version History & Queries ✅

- ✅ **VERSION-TREE REPORT** - RFC 3253 compliant version history queries
- ✅ **Version properties** - `checked-in`, `checked-out`, `version-name`, `version-history`
- ✅ **Virtual version paths** - `/.versions/{user}/{collection}/{item}/` endpoints
- ✅ **Retrieve specific versions** - GET any historical version by SHA
- ✅ **Version metadata** - Author, timestamp, commit message

### Auto-Versioning ✅

- ✅ **checkout-checkin mode** - Automatic commits on PUT operations
- ✅ **Transparent versioning** - No client changes required
- ✅ **Commit message generation** - `AUTO-VERSION: Create/Update {item}`

### Checkout Management ✅

- ✅ **Fork policies** - `forbidden`, `discouraged`, `ok` for concurrent checkouts
- ✅ **Checkout expiration** - Automatic cleanup of stale checkouts
- ✅ **Checkout state tracking** - Per-resource checkout metadata
- ✅ **Multi-user coordination** - Prevents conflicts in shared calendars

### Activities (Change Sets) ✅

- ✅ **MKACTIVITY method** - Create logical change groupings
- ✅ **Activity associations** - Link checkouts to activities
- ✅ **Automatic version tracking** - Checkins add versions to activities
- ✅ **Activity metadata** - Display name, description, creator, timestamps
- ✅ **JSON storage** - Activities stored in `.activities/` directory

## What's Not Implemented

<Aside type="caution">
The following RFC 3253 features are **not implemented** (rarely used in practice):

- ⚠️ **MERGE** - Merging between activities/branches
- ⚠️ **BASELINE** - Collection-level snapshots
- ⚠️ **WORKSPACE** - Working collections (separate from version history)
- ⚠️ **UPDATE** - Pulling from version history

These features are advanced and rarely required by CalDAV clients.
</Aside>

## Key Features

### Git-Backed Version History

All version data is stored in a git repository within your storage folder:

```bash
# Storage structure
/var/lib/radicale/collections/
├── .git/                    # Git repository
├── .activities/             # Activity metadata (JSON)
│   └── {uuid}.json
├── collection-root/         # Actual calendar/contact data
│   └── alice/
│       └── calendar.ics/
│           └── event.ics
└── .Radicale.lock
```

This provides:

- **Standard git tools** - Use `git log`, `git diff`, `git show` directly
- **Reliable versioning** - Battle-tested git storage backend
- **Easy backup** - Clone/push the git repository
- **Audit trail** - Complete history with timestamps and authors

### Virtual Version Paths

Access version history through WebDAV-friendly URLs:

```
/.versions/{user}/{collection}/{item}/        # Version list (XML)
/.versions/{user}/{collection}/{item}/{sha}   # Specific version content
```

Example:
```bash
# List versions
curl https://server/.versions/alice/calendar.ics/event.ics/

# Get specific version
curl https://server/.versions/alice/calendar.ics/event.ics/abc12345
```

### Explicit Checkout/Checkin Workflow

RFC 3253 defines a lock-based editing workflow:

1. **CHECKOUT** - Lock the resource
2. **Modify** - Update with PUT
3. **CHECKIN** - Commit changes and unlock

```bash
# Lock for editing
curl -X CHECKOUT https://server/alice/calendar.ics/event.ics

# Make changes
curl -X PUT -d @updated-event.ics https://server/alice/calendar.ics/event.ics

# Create version
curl -X CHECKIN https://server/alice/calendar.ics/event.ics
```

This prevents concurrent edits in shared calendars and provides clear audit trails.

### Version Labels (Git Tags)

Mark important versions with human-readable labels:

```bash
# Add label to current version
curl -X LABEL -H "Content-Type: application/xml" \
  -d '<D:label xmlns:D="DAV:">
        <D:add><D:label-name>production</D:label-name></D:add>
      </D:label>' \
  https://server/alice/calendar.ics/event.ics
```

Labels are stored as git tags with path-based namespacing:
```
alice/calendar.ics/event.ics/production
alice/calendar.ics/event.ics/v1.0
alice/calendar.ics/event.ics/stable
```

### Activities (Change Sets)

Group related changes across multiple resources:

```bash
# Create activity
curl -X MKACTIVITY -H "Content-Type: application/xml" \
  -d '<D:mkactivity xmlns:D="DAV:">
        <D:displayname>Q1 2025 Planning</D:displayname>
        <D:comment>All calendar updates for Q1</D:comment>
      </D:mkactivity>' \
  https://server/.activities/new

# Checkout with activity
curl -X CHECKOUT -H "Content-Type: application/xml" \
  -d '<D:checkout xmlns:D="DAV:">
        <D:activity-set>
          <D:href>/.activities/{uuid}</D:href>
        </D:activity-set>
      </D:checkout>' \
  https://server/alice/calendar.ics/event.ics
```

When you checkin, the new version is automatically associated with the activity.

## Configuration

Enable versioning in your Radicale configuration:

```ini
[storage]
# Enable RFC 3253 versioning
versioning = True

# Maximum versions in history (default: 100)
versioning_max_history = 100

# Auto-versioning mode: disabled | checkout-checkin
versioning_auto = checkout-checkin

# Fork policy: forbidden | discouraged | ok
versioning_checkout_fork = forbidden

# Checkout timeout in seconds (0 = never expire)
versioning_checkout_timeout = 3600
```

### Prerequisites

Versioning requires git installed and initialized:

```bash
# Install git
sudo apt install git  # Debian/Ubuntu
sudo yum install git  # RHEL/CentOS
brew install git      # macOS

# Initialize git in storage folder
cd /var/lib/radicale/collections
git init
git config user.email "radicale@localhost"
git config user.name "Radicale"
```

## Use Cases

<CardGrid>
  <Card title="Audit Trail" icon="list-format">
    Track all changes to calendar/contact data for compliance and accountability.
  </Card>

  <Card title="Undo Changes" icon="refresh">
    Restore calendar events or contacts to previous versions when mistakes happen.
  </Card>

  <Card title="Conflict Prevention" icon="warning">
    Use CHECKOUT to lock resources and prevent concurrent edits in shared calendars.
  </Card>

  <Card title="Change Sets" icon="list-format">
    Group related changes across multiple resources using activities for better organization.
  </Card>

  <Card title="Release Management" icon="seti:tag">
    Use version labels to mark stable calendar versions or important milestones.
  </Card>

  <Card title="Compliance" icon="approve-check-circle">
    Meet regulatory requirements for data change tracking and audit trails.
  </Card>
</CardGrid>

## Example Workflows

### Audit Trail

Track all changes with complete history:

```bash
# Enable auto-versioning
[storage]
versioning = True
versioning_auto = checkout-checkin

# All PUT operations now create git commits automatically
# View history:
curl https://server/.versions/alice/calendar.ics/event.ics/
```

### Explicit Version Control

Lock resources before editing:

```bash
# 1. Checkout (lock)
curl -X CHECKOUT https://server/alice/calendar.ics/meeting.ics

# 2. Edit
curl -X PUT -d @updated.ics https://server/alice/calendar.ics/meeting.ics

# 3. Checkin (unlock and commit)
curl -X CHECKIN https://server/alice/calendar.ics/meeting.ics
```

### Undo Mistake

Restore to previous version:

```bash
# 1. Get old content
curl https://server/.versions/alice/calendar.ics/event.ics/abc12345 > old.ics

# 2. Restore by PUTting old content
curl -X PUT -d @old.ics https://server/alice/calendar.ics/event.ics
```

### Organize with Activities

Group related changes:

```bash
# 1. Create activity
curl -X MKACTIVITY -d '<D:mkactivity xmlns:D="DAV:">
  <D:displayname>Conference Planning</D:displayname>
</D:mkactivity>' https://server/.activities/new

# 2. Checkout multiple events with same activity
curl -X CHECKOUT -d '<D:checkout xmlns:D="DAV:">
  <D:activity-set><D:href>/.activities/{uuid}</D:href></D:activity-set>
</D:checkout>' https://server/alice/calendar.ics/event-1.ics

# 3. Make changes and checkin
# All versions automatically tracked in activity
```

## Testing & Validation

Radicale's RFC 3253 implementation is validated through comprehensive testing:

- ✅ **28 pytest tests** covering all versioning operations
- ✅ **Checkout workflow tests** - Fork policies, expiration, concurrent access
- ✅ **LABEL operation tests** - ADD, SET, REMOVE label operations
- ✅ **MKACTIVITY tests** - Activity creation and association
- ✅ **VERSION-TREE REPORT tests** - XML output validation
- ✅ **Auto-versioning tests** - checkout-checkin mode validation
- ✅ **Integration tests** - Git repository consistency checks

## Version Properties

PROPFIND returns versioning properties when enabled:

```xml
<D:propfind xmlns:D="DAV:">
  <D:prop>
    <D:checked-in/>
    <D:checked-out/>
    <D:version-history/>
    <D:version-name/>
    <D:creator-displayname/>
    <D:getlastmodified/>
    <D:label-name-set/>
  </D:prop>
</D:propfind>
```

| Property | Description |
|----------|-------------|
| `checked-in` | URL of current version (when not checked out) |
| `checked-out` | URL of version being edited (when checked out) |
| `version-history` | URL of version history resource |
| `version-name` | Short version identifier (git SHA prefix) |
| `creator-displayname` | Author of the version |
| `getlastmodified` | Version timestamp |
| `label-name-set` | All labels for current version |

## VERSION-TREE REPORT

Query version history using the RFC 3253 report:

```bash
curl -X REPORT -H "Content-Type: application/xml" \
  -d '<?xml version="1.0"?>
      <D:version-tree xmlns:D="DAV:">
        <D:prop>
          <D:version-name/>
          <D:creator-displayname/>
          <D:getlastmodified/>
          <D:comment/>
        </D:prop>
      </D:version-tree>' \
  https://server/alice/calendar.ics/event.ics
```

Response includes XML with version list sorted by timestamp.

## Learn More

<CardGrid>
  <Card title="Tutorial: Enable Versioning" icon="rocket">
    Step-by-step guide to set up git-backed versioning.

    [Start tutorial →](/tutorials/versioning/)
  </Card>

  <Card title="How-To: Version Labels" icon="seti:tag">
    Learn to use version labels for marking important versions.

    [View guide →](/how-to/versioning/labels/)
  </Card>

  <Card title="How-To: Activities" icon="list-format">
    Organize changes with activities and change sets.

    [View guide →](/how-to/versioning/activities/)
  </Card>

  <Card title="Explanation: Versioning Concepts" icon="information">
    Understand when and why to use versioning.

    [Learn more →](/explanations/versioning/)
  </Card>
</CardGrid>

<Aside type="note">
See `/home/rpm/claude/radicale/Radicale/ADVANCED-FEATURES.md` (lines 965-1789) for complete versioning documentation including detailed examples and troubleshooting.
</Aside>
